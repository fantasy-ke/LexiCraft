@use 'anim' as *;
@use 'shepherd.css';

:root {
  --color-reverse-white: #ffffff;
  --color-reverse-black: #0f172a;
  --bg-history: #ffffff;
  --color-item-border: rgba(0, 0, 0, 0.05);

  --color-tooltip-bg: rgba(255, 255, 255, 0.8);
  --color-font-2: #1e293b;
  --color-font-3: #64748b;
  --color-font-active-1: #ffffff;
  --color-scrollbar: #e2e8f0;

  --color-sub-gray: #94a3b8;

  --article-width: 60vw;
  --article-toolbar-width: 60vw;
  --article-panel-width: 18rem;
  --article-panel-margin-left: calc(50% + var(--article-width) / 2 + 1rem);

  --toolbar-width: 50vw;
  --panel-width: 20rem;

  --modal-padding: 1.5rem;
  --space: 1rem;
  --stat-gap: 1.2rem;
  --word-panel-margin-left: calc(50% + var(--toolbar-width) / 2 + 1rem);
  --anim-time: 0.4s;

  --color-input-color: #1e293b;
  --color-input-bg: #f8fafc;
  --color-input-border: #e2e8f0;
  --color-input-icon: #94a3b8;

  --color-textarea-bg: #f8fafc;
  --color-article: #0f172a;

  --aside-width: 14rem;

  --font-family: 'Inter', -apple-system, system-ui, sans-serif;
  --word-font-family: 'JetBrains Mono', ui-monospace, monospace;
  --en-article-family: 'Publico', Georgia, serif;
  --zh-article-family: 'PingFang SC', 'STHeiti', 'Microsoft YaHei', sans-serif;

  --color-primary: #f1f5f9;
  --color-second: #ffffff;
  --color-third: #e2e8f0;
  --color-fourth: #cbd5e1;
  --color-fifth: #fefce8;

  --color-card-active: #f1f5f9;
  --color-icon-hightlight: #3b82f6;
  --color-sub-text: #64748b;
  --color-main-text: #334155;
  --color-select-bg: #3b82f6;

  --color-progress-bar: #e2e8f0;

  --color-label-bg: #f1f5f9;
  --color-link: #2563eb;

  --color-card-bg: #ffffff;

  --bg-card-primary: #ffffff;
  --bg-card-secend: #f8fafc;

  --bg-book: #f1f5f9;

  --color-line: #f1f5f9;

  /* Premium Gradients */
  --grad-premium: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
  --grad-gold: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
  --grad-surface: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.05) 100%);

  /* Logic Colors */
  --layout-bg: #f8fafc;
  --header-bg: #ffffff;
  --sidebar-bg: #ffffff;
  --border-color: #e2e8f0;

  --text-primary: #0f172a;
  --text-secondary: #475569;
  --text-tertiary: #94a3b8;
  --text-active: #2563eb;

  --hover-bg: #f1f5f9;
  --active-bg: #eff6ff;

  --shadow-premium: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-color: rgba(0, 0, 0, 0.05);
}

html.dark {
  --color-reverse-white: black;
  --color-reverse-black: white;

  --color-primary: #202124;
  --color-second: #292a2d;
  --color-third: #35373a;
  --color-fourth: rgb(70, 70, 70);
  --color-fifth: rgb(84, 84, 84);

  --color-card-active: rgb(84, 84, 84);
  --color-icon-hightlight: rgb(147, 173, 227);
  --color-sub-text: #b8b8b8;
  --color-main-text: rgba(249, 250, 251, 0.8);
  --color-select-bg: rgb(147, 173, 227);

  --bg-history: rgb(43, 45, 48);
  --color-item-border: rgb(41, 41, 41);

  --color-tooltip-bg: #35373a;
  --color-font-2: rgba(255, 255, 255, 0.5);
  --color-font-3: rgba(255, 255, 255, 0.3);

  --color-sub-gray: #383737;
  --color-scrollbar: rgb(92, 93, 94);

  --color-input-color: white;
  --color-input-bg: var(--color-third);

  --color-textarea-bg: rgb(43, 45, 48);
  --color-article: white;

  --color-progress-bar: rgb(73, 77, 82) !important;

  --color-label-bg: rgb(10, 10, 10);

  --color-card-bg: var(--color-second);

  --bg-card-primary: rgb(30, 31, 34);
  --bg-card-secend: rgb(43, 45, 48);

  --bg-book: #35373a;

  --color-line: rgb(66, 66, 66);

  /* Logic Colors Dark Mode Overrides */
  --layout-bg: #292A2D;
  --header-bg: #292A2D;
  --sidebar-bg: #292A2D;
  --border-color: #334155;
  /* Slate 700 */

  --text-primary: #f1f5f9;
  /* Slate 100 */
  --text-secondary: #94a3b8;
  /* Slate 400 */
  --text-tertiary: #64748b;
  /* Slate 500 */
  --text-active: #60a5fa;
  /* Blue 400 */

  --hover-bg: #334155;
  /* Slate 700 */
  // --active-bg: #1e293b; /* Slate 800 - distinct from hover? maybe darker blue */
  --active-bg: rgba(59, 130, 246, 0.15);
  /* Translucent Blue */

  --shadow-color: rgba(0, 0, 0, 0.3);
}

@media (max-width: 1720px) {
  :root {
    --toolbar-width: 55vw;
    --panel-width: 20rem;
    --space: 0.7rem;

    --article-width: 65vw;
    --article-toolbar-width: 65vw;
    --article-panel-width: 17rem;
  }
}

@media (max-width: 1560px) {
  :root {
    --article-width: 70vw;
    --article-toolbar-width: 70vw;
    --article-panel-width: 15rem;
    --toolbar-width: 60vw;
  }
}

@media (max-width: 1366px) {
  :root {
    --toolbar-width: 65vw;
    --panel-width: 18rem;
    --stat-gap: 0.5rem;
    --space: 0.5rem;

    --article-width: 75vw;
    --article-toolbar-width: 75vw;
    --article-panel-width: 12rem;
  }
}

@media (max-width: 1150px) {
  :root {
    --article-width: 90vw;
    --article-toolbar-width: 90vw;
    --article-panel-width: 15rem;
    --toolbar-width: 80vw;
  }
}

// 移动端适配
@media (max-width: 768px) {
  :root {
    --toolbar-width: 100vw;
    --panel-width: 100vw;
    --article-width: 100vw;
    --article-toolbar-width: 100vw;
    --space: 0.5rem;
    --stat-gap: 0.3rem;
    --article-panel-width: 100vw;
    --word-panel-margin-left: 0;
  }
}

@media (max-width: 480px) {
  :root {
    --space: 0.3rem;
    --stat-gap: 0.2rem;
  }
}

.anim {
  transition: background var(--anim-time),
    color var(--anim-time),
    border var(--anim-time),
    opacity var(--anim-time);
}

.en-article-family {
  font-family: var(--en-article-family);
}

.font-family {
  font-family: var(--font-family);
}

html,
body {
  //font-size: 1px;
  @apply p-0 m-0 overflow-x-hidden;
  color: var(--color-main-text);
  font-family: var(--font-family);
  background: var(--color-primary);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.page {
  @apply relative z-1 h-full w-full flex flex-col;
}

.mobile-page {
  @apply fixed left-0 right-0 bottom-0 top-0 overflow-auto font-size-18 w-full h-full flex flex-col;

  &>.page-content {
    @apply p-10 box-border overflow-auto;
  }
}

#app {
  width: 100vw;
  min-height: 100vh;
}

a {
  color: var(--color-link);
  text-decoration: none;
}

.link {
  color: var(--color-link);
  @apply hover:opacity-80;
}

.cp {
  @apply cursor-pointer;
}

@supports selector(::-webkit-scrollbar) {
  ::-webkit-scrollbar {
    width: 0.5rem;
    height: 0.6rem;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 0.1rem;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-scrollbar);
    border-radius: 0.6rem;
  }
}

.panel-page-item {
  @apply flex flex-col h-full box-border;
  padding-bottom: var(--space);
}

.scroll {
  padding: 0 var(--space);
  @apply flex-1 overflow-auto;
}

.virtual-list {
  @apply overflow-overlay h-full;
  padding: 0 var(--space);
}

.list-item-wrapper {
  padding-bottom: 1rem;
}

.common-list-item {
  @apply cursor-pointer w-full box-border bg-third rounded-lg flex justify-between gap-1 transition-all duration-300 p-2;
  color: var(--color-main-text);
  border: 1px solid var(--color-item-border);

  .left {
    @apply flex gap-1;

    .title-wrapper {
      @apply flex flex-col gap-0.5 word-break-break-word;
    }
  }

  .right {
    @apply flex flex-col gap-0.5 transition-all duration-300;
  }

  svg {
    @apply opacity-0;
  }

  &.active {
    @apply bg-fifth;

    .item-sub-title {
      color: var(--color-sub-text);
    }
  }

  .fill {
    svg {
      opacity: 1 !important;
    }
  }

  &:hover {
    @extend .active;

    svg {
      opacity: 1;
    }
  }

  .item-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--color-main-text);
    flex-wrap: wrap;

    span {
      flex-shrink: 0;
    }

    .word {
      font-size: 1.2rem;
    }

    .phonetic {
      font-size: 0.9rem;
      color: gray;
    }
  }

  .item-sub-title {
    font-size: 1rem;
    color: gray;
  }
}

.word-shadow {
  color: transparent !important;
  text-shadow: #b0b0b0 0 0 0.5rem;
  user-select: none;
}

.common-title {
  min-height: 2.8rem;
  font-size: 1.1rem;
  color: var(--color-main-text);
  display: flex;
  justify-content: center;
  align-items: center;
}

.slide {
  flex: 1;
  width: 100%;
  transition: height 0.3s;
  position: relative;
  overflow: hidden;

  .slide-infinite {
    z-index: 1;
    margin-top: 0;
    transition: all 0.3s;
  }

  .slide-list {
    height: 100%;
    width: 100%;
    display: flex;
    position: relative;
  }
}

.container2 {
  @apply w-5/10 pt-5;
}

.center {
  @apply flex justify-center items-center;
}

.center-col {
  @extend .center;
  @apply flex-col;
}

.card-white {
  @apply card;
  background: var(--color-card-bg);
  border: 1px solid var(--color-item-border);
  box-shadow: var(--shadow-premium);
  transition: transform 0.3s ease, box-shadow 0.3s ease;

  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
}

.glass {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.dark .glass {
  background: rgba(15, 23, 42, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.grad-text {
  background: var(--grad-premium);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.inline-center {
  @apply inline-flex justify-center items-center;
}

.title {
  @apply text-lg font-medium;
}

.book {
  @extend .anim;
  @apply p-3 rounded-md relative cursor-pointer hover:bg-fifth flex flex-col justify-between shrink-0;
  background: var(--bg-book);
  $w: 7rem;
  width: $w;
  height: calc($w * 1.4);
}

.line {
  width: 100%;
  border-bottom: 1px solid var(--color-line);
  @apply hover:text-blue-700;
}

.line-white {
  width: 100%;
  border-bottom: 1px dashed #ababab;
}

.page-title {
  @apply text-2xl;
}

.red-point {
  @apply bg-red w-3 h-3 rounded-full absolute right-3;
}

.cursor {
  position: absolute;
  left: 0;
  top: 0;
  height: 1.8rem;
  animation: underline 1s infinite steps(1, start);
}

@keyframes underline {

  0%,
  100% {
    border-left: 0.1rem solid var(--color-article);
  }

  50% {
    border-left: 0.1rem solid transparent;
  }
}

#typing-listener {
  @apply fixed left-[-9999px] top-[-9999px] w-1 h-1 opacity-0.01 z-[-1] pointer-events-none border-none outline-none bg-transparent text-transparent;
  font-size: 16px; // 防止iOS缩放
}

.btn-no-margin {
  .base-button+.base-button {
    margin-left: 0 !important;
  }
}

.target-number {
  @apply text-3xl !;
  color: rgb(176, 116, 211) !important;
}